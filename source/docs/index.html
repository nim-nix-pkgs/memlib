<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- CSS -->
<title>memlib</title>
<link rel="stylesheet" type="text/css" href="nimdoc.out.css">

<script type="text/javascript" src="dochack.js"></script>

<script type="text/javascript">
function main() {
  var pragmaDots = document.getElementsByClassName("pragmadots");
  for (var i = 0; i < pragmaDots.length; i++) {
    pragmaDots[i].onclick = function(event) {
      // Hide tease
      event.target.parentNode.style.display = "none";
      // Show actual
      event.target.parentNode.nextElementSibling.style.display = "inline";
    }
  }

  const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
  function switchTheme(e) {
      if (e.target.checked) {
          document.documentElement.setAttribute('data-theme', 'dark');
          localStorage.setItem('theme', 'dark');
      } else {
          document.documentElement.setAttribute('data-theme', 'light');
          localStorage.setItem('theme', 'light');
      }
  }

  toggleSwitch.addEventListener('change', switchTheme, false);


  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    document.documentElement.setAttribute('data-theme', "dark");
    toggleSwitch.checked = true;
  } else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
    document.documentElement.setAttribute('data-theme', "light");
    toggleSwitch.checked = false;
  } else {
    const currentTheme = localStorage.getItem('theme') ? localStorage.getItem('theme') : null;
    if (currentTheme) {
      document.documentElement.setAttribute('data-theme', currentTheme);

      if (currentTheme === 'dark') {
        toggleSwitch.checked = true;
      }
    }
  }
}
</script>

</head>
<body onload="main()">
<div class="document" id="documentId">
  <div class="container">
    <h1 class="title">memlib</h1>
    <div class="row">
  <div class="three columns">
  <div class="theme-switch-wrapper">
    <label class="theme-switch" for="checkbox">
      <input type="checkbox" id="checkbox" />
      <div class="slider round"></div>
    </label>
    &nbsp;&nbsp;&nbsp; <em>Dark Mode</em>
  </div>
  <div id="global-links">
    <ul class="simple">
      <li><a href="https://github.com/khchen/memlib">Github Page</a></li>
    </ul>
  </div>
  <ul class="simple simple-toc" id="toc-list">

<li>
  <a class="reference reference-toplevel" href="#7" id="57">Types</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#MemoryModule"
    title="MemoryModule = ptr MemoryModuleObj"><wbr />Memory<wbr />Module<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#DllContent"
    title="DllContent = distinct string"><wbr />Dll<wbr />Content<span class="attachedType"></span></a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#12" id="62">Procs</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#checkedLoadLib%2CDllContent"
    title="checkedLoadLib(data: DllContent): MemoryModule"><wbr />checked<wbr />Load<wbr />Lib<span class="attachedType">DllContent</span></a></li>
  <li><a class="reference" href="#checkedLoadLib%2CopenArray%5B%5D"
    title="checkedLoadLib(data: openArray[byte | char]): MemoryModule"><wbr />checked<wbr />Load<wbr />Lib<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#checkedSymAddr%2CMemoryModule%2C"
    title="checkedSymAddr(lib: MemoryModule; name: string | cstring): pointer"><wbr />checked<wbr />Sym<wbr />Addr<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#checkedSymAddr%2CMemoryModule%2Crange%5B%5D"
    title="checkedSymAddr(lib: MemoryModule; ordinal: range[0 .. 65535]): pointer"><wbr />checked<wbr />Sym<wbr />Addr<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#loadLib%2CDllContent"
    title="loadLib(data: DllContent): MemoryModule"><wbr />load<wbr />Lib<span class="attachedType">DllContent</span></a></li>
  <li><a class="reference" href="#loadLib%2CopenArray%5B%5D"
    title="loadLib(data: openArray[byte | char]): MemoryModule"><wbr />load<wbr />Lib<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#symAddr%2CMemoryModule%2C"
    title="symAddr(lib: MemoryModule; name: string | cstring): pointer"><wbr />sym<wbr />Addr<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#symAddr%2CMemoryModule%2Crange%5B%5D"
    title="symAddr(lib: MemoryModule; ordinal: range[0 .. 65535]): pointer"><wbr />sym<wbr />Addr<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#unloadLib%2CMemoryModule"
    title="unloadLib(lib: MemoryModule)"><wbr />unload<wbr />Lib<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#run%2CMemoryModule"
    title="run(lib: MemoryModule): int"><wbr />run<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#findResource%2CHMODULE%2CLPCTSTR%2CLPCTSTR%2CWORD"
    title="findResource(lib: HMODULE; name: LPCTSTR; typ: LPCTSTR; lang: WORD = 0): HRSRC"><wbr />find<wbr />Resource<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#sizeOfResource%2CHMODULE%2CHRSRC"
    title="sizeOfResource(lib: HMODULE; resource: HRSRC): DWORD"><wbr />size<wbr />Of<wbr />Resource<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#loadResource%2CHMODULE%2CHRSRC"
    title="loadResource(lib: HMODULE; resource: HRSRC): HGLOBAL"><wbr />load<wbr />Resource<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#loadString%2CHMODULE%2CUINT%2CWORD"
    title="loadString(lib: HMODULE; id: UINT; lang: WORD = 0): string"><wbr />load<wbr />String<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#findResource%2CMemoryModule%2CLPCTSTR%2CLPCTSTR%2CWORD"
    title="findResource(lib: MemoryModule; name: LPCTSTR; typ: LPCTSTR; lang: WORD = 0): HRSRC"><wbr />find<wbr />Resource<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#sizeOfResource%2CMemoryModule%2CHRSRC"
    title="sizeOfResource(lib: MemoryModule; resource: HRSRC): DWORD"><wbr />size<wbr />Of<wbr />Resource<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#loadResource%2CMemoryModule%2CHRSRC"
    title="loadResource(lib: MemoryModule; resource: HRSRC): HGLOBAL"><wbr />load<wbr />Resource<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#loadString%2CMemoryModule%2CUINT%2CWORD"
    title="loadString(lib: MemoryModule; id: UINT; lang: WORD = 0): string"><wbr />load<wbr />String<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#unhook%2CMemoryModule"
    title="unhook(lib: MemoryModule)"><wbr />unhook<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#hook%2CMemoryModule%2Cstring"
    title="hook(lib: MemoryModule; name: string)"><wbr />hook<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#checkedMemLoopup%2Cptr.pointer%2CDllContent%2CLPCSTR"
    title="checkedMemLoopup(callPtr: ptr pointer; dll: DllContent; sym: LPCSTR)"><wbr />checked<wbr />Mem<wbr />Loopup<span class="attachedType">DllContent</span></a></li>
  <li><a class="reference" href="#memLoopup%2Cptr.pointer%2CDllContent%2CLPCSTR"
    title="memLoopup(callPtr: ptr pointer; dll: DllContent; sym: LPCSTR)"><wbr />mem<wbr />Loopup<span class="attachedType">DllContent</span></a></li>
  <li><a class="reference" href="#checkedLibLoopup%2Cptr.pointer%2CMemoryModule%2CLPCSTR"
    title="checkedLibLoopup(callPtr: ptr pointer; lib: MemoryModule; sym: LPCSTR)"><wbr />checked<wbr />Lib<wbr />Loopup<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#libLoopup%2Cptr.pointer%2CMemoryModule%2CLPCSTR"
    title="libLoopup(callPtr: ptr pointer; lib: MemoryModule; sym: LPCSTR)"><wbr />lib<wbr />Loopup<span class="attachedType">MemoryModule</span></a></li>
  <li><a class="reference" href="#checkedRtLoopup%2Cptr.pointer%2Cstring%2CLPCSTR"
    title="checkedRtLoopup(callPtr: ptr pointer; name: string; sym: LPCSTR)"><wbr />checked<wbr />Rt<wbr />Loopup<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#rtLoopup%2Cptr.pointer%2Cstring%2CLPCSTR"
    title="rtLoopup(callPtr: ptr pointer; name: string; sym: LPCSTR)"><wbr />rt<wbr />Loopup<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#staticReadDllWithName%2Cstring"
    title="staticReadDllWithName(dll: string; hint = true): (string, DllContent)"><wbr />static<wbr />Read<wbr />Dll<wbr />With<wbr />Name<span class="attachedType">DllContent</span></a></li>
  <li><a class="reference" href="#staticReadDll%2Cstring"
    title="staticReadDll(dll: string; hint = true): DllContent"><wbr />static<wbr />Read<wbr />Dll<span class="attachedType">DllContent</span></a></li>

  </ul>
</li>
<li>
  <a class="reference reference-toplevel" href="#17" id="67">Macros</a>
  <ul class="simple simple-toc-section">
      <li><a class="reference" href="#checkedMemlib.m%2Cuntyped%2Cuntyped"
    title="checkedMemlib(dll, def: untyped): untyped"><wbr />checked<wbr />Memlib<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#memlib.m%2Cuntyped%2Cuntyped"
    title="memlib(dll, def: untyped): untyped"><wbr />memlib<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#withPragma.m%2Cuntyped%2Cuntyped"
    title="withPragma(pragma, body: untyped): untyped"><wbr />with<wbr />Pragma<span class="attachedType"></span></a></li>
  <li><a class="reference" href="#buildPragma.m%2Cuntyped%2Cuntyped"
    title="buildPragma(pragma, body: untyped): untyped"><wbr />build<wbr />Pragma<span class="attachedType"></span></a></li>

  </ul>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
  <div id="tocRoot"></div>
  
  <p class="module-desc">This module is designed to be a drop-in replacement for <tt class="docutils literal"><span class="pre">dynlib pragma</span></tt> and <tt class="docutils literal"><span class="pre">dynlib module</span></tt> in Windows. The main part of this module is a pure nim implementation of the famous MemoryModule library. So that the we can embed all DLLs into the main EXE file.</p>
  
<div class="section" id="7">
<h1><a class="toc-backref" href="#7">Types</a></h1>
<dl class="item">
<a id="MemoryModule"></a>
<dt><pre><a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a> <span class="Other">=</span> <span class="Keyword">ptr</span> <span class="Identifier">MemoryModuleObj</span></pre></dt>
<dd>

Pointer to a MemoryModule object.

</dd>
<a id="DllContent"></a>
<dt><pre><a href="memlib.html#DllContent"><span class="Identifier">DllContent</span></a> <span class="Other">=</span> <span class="Keyword">distinct</span> <span class="Identifier">string</span></pre></dt>
<dd>

Represents DLL file in binary format.

</dd>

</dl></div>
<div class="section" id="12">
<h1><a class="toc-backref" href="#12">Procs</a></h1>
<dl class="item">
<a id="checkedLoadLib,DllContent"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#checkedLoadLib%2CDllContent"><span class="Identifier">checkedLoadLib</span></a><span class="Other">(</span><span class="Identifier">data</span><span class="Other">:</span> <a href="memlib.html#DllContent"><span class="Identifier">DllContent</span></a><span class="Other">)</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Loads a DLL from memory. Raise <tt class="docutils literal"><span class="pre">LibraryError</span></tt> if the DLL could not be loaded.

</dd>
<a id="checkedLoadLib,openArray[]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#checkedLoadLib%2CopenArray%5B%5D"><span class="Identifier">checkedLoadLib</span></a><span class="Other">(</span><span class="Identifier">data</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">byte</span> <span class="Operator">|</span> <span class="Identifier">char</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Loads a DLL from memory. Raise <tt class="docutils literal"><span class="pre">LibraryError</span></tt> if the DLL could not be loaded.

</dd>
<a id="checkedSymAddr,MemoryModule,"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#checkedSymAddr%2CMemoryModule%2C"><span class="Identifier">checkedSymAddr</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">;</span> <span class="Identifier">name</span><span class="Other">:</span> <span class="Identifier">string</span> <span class="Operator">|</span> <span class="Identifier">cstring</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">pointer</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Retrieves the address of a procedure from DLL by name. Raise <tt class="docutils literal"><span class="pre">LibraryError</span></tt> if the symbol could not be found.

</dd>
<a id="checkedSymAddr,MemoryModule,range[]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#checkedSymAddr%2CMemoryModule%2Crange%5B%5D"><span class="Identifier">checkedSymAddr</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">;</span> <span class="Identifier">ordinal</span><span class="Other">:</span> <span class="Identifier">range</span><span class="Other">[</span><span class="DecNumber">0</span> <span class="Operator">..</span> <span class="DecNumber">65535</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">pointer</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Retrieves the address of a procedure from DLL by ordinal. Raise <tt class="docutils literal"><span class="pre">LibraryError</span></tt> if the ordinal out of range.

</dd>
<a id="loadLib,DllContent"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#loadLib%2CDllContent"><span class="Identifier">loadLib</span></a><span class="Other">(</span><span class="Identifier">data</span><span class="Other">:</span> <a href="memlib.html#DllContent"><span class="Identifier">DllContent</span></a><span class="Other">)</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Loads a DLL from memory. Returns <tt class="docutils literal"><span class="pre">nil</span></tt> if the DLL could not be loaded.

</dd>
<a id="loadLib,openArray[]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#loadLib%2CopenArray%5B%5D"><span class="Identifier">loadLib</span></a><span class="Other">(</span><span class="Identifier">data</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">byte</span> <span class="Operator">|</span> <span class="Identifier">char</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Loads a DLL from memory. Returns <tt class="docutils literal"><span class="pre">nil</span></tt> if the DLL could not be loaded.

</dd>
<a id="symAddr,MemoryModule,"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#symAddr%2CMemoryModule%2C"><span class="Identifier">symAddr</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">;</span> <span class="Identifier">name</span><span class="Other">:</span> <span class="Identifier">string</span> <span class="Operator">|</span> <span class="Identifier">cstring</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">pointer</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Retrieves the address of a procedure from DLL by name. Returns <tt class="docutils literal"><span class="pre">nil</span></tt> if the symbol could not be found.

</dd>
<a id="symAddr,MemoryModule,range[]"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#symAddr%2CMemoryModule%2Crange%5B%5D"><span class="Identifier">symAddr</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">;</span> <span class="Identifier">ordinal</span><span class="Other">:</span> <span class="Identifier">range</span><span class="Other">[</span><span class="DecNumber">0</span> <span class="Operator">..</span> <span class="DecNumber">65535</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">pointer</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Retrieves the address of a procedure from DLL by ordinal. Returns <tt class="docutils literal"><span class="pre">nil</span></tt> if the ordinal out of range.

</dd>
<a id="unloadLib,MemoryModule"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#unloadLib%2CMemoryModule"><span class="Identifier">unloadLib</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Unloads the DLL.

</dd>
<a id="run,MemoryModule"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#run%2CMemoryModule"><span class="Identifier">run</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">discardable</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

<p>Execute entry point (EXE only). The entry point can only be executed if the EXE has been loaded to the correct base address or it could be relocated (i.e. relocation information have not been stripped by the linker).</p>
<p>Important: calling this function will not return, i.e. once the loaded EXE finished running, the process will terminate.</p>
<p>Raise <tt class="docutils literal"><span class="pre">LibraryError</span></tt> if the entry point could not be executed.</p>


</dd>
<a id="findResource,HMODULE,LPCTSTR,LPCTSTR,WORD"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#findResource%2CHMODULE%2CLPCTSTR%2CLPCTSTR%2CWORD"><span class="Identifier">findResource</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <span class="Identifier">HMODULE</span><span class="Other">;</span> <span class="Identifier">name</span><span class="Other">:</span> <span class="Identifier">LPCTSTR</span><span class="Other">;</span> <span class="Identifier">typ</span><span class="Other">:</span> <span class="Identifier">LPCTSTR</span><span class="Other">;</span> <span class="Identifier">lang</span><span class="Other">:</span> <span class="Identifier">WORD</span> <span class="Other">=</span> <span class="DecNumber">0</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">HRSRC</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Find the location of a resource with the specified type, name and language.

</dd>
<a id="sizeOfResource,HMODULE,HRSRC"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#sizeOfResource%2CHMODULE%2CHRSRC"><span class="Identifier">sizeOfResource</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <span class="Identifier">HMODULE</span><span class="Other">;</span> <span class="Identifier">resource</span><span class="Other">:</span> <span class="Identifier">HRSRC</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">DWORD</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Get the size of the resource in bytes.

</dd>
<a id="loadResource,HMODULE,HRSRC"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#loadResource%2CHMODULE%2CHRSRC"><span class="Identifier">loadResource</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <span class="Identifier">HMODULE</span><span class="Other">;</span> <span class="Identifier">resource</span><span class="Other">:</span> <span class="Identifier">HRSRC</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">HGLOBAL</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Get a pointer to the contents of the resource.

</dd>
<a id="loadString,HMODULE,UINT,WORD"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#loadString%2CHMODULE%2CUINT%2CWORD"><span class="Identifier">loadString</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <span class="Identifier">HMODULE</span><span class="Other">;</span> <span class="Identifier">id</span><span class="Other">:</span> <span class="Identifier">UINT</span><span class="Other">;</span> <span class="Identifier">lang</span><span class="Other">:</span> <span class="Identifier">WORD</span> <span class="Other">=</span> <span class="DecNumber">0</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Load a string resource.

</dd>
<a id="findResource,MemoryModule,LPCTSTR,LPCTSTR,WORD"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#findResource%2CMemoryModule%2CLPCTSTR%2CLPCTSTR%2CWORD"><span class="Identifier">findResource</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">;</span> <span class="Identifier">name</span><span class="Other">:</span> <span class="Identifier">LPCTSTR</span><span class="Other">;</span> <span class="Identifier">typ</span><span class="Other">:</span> <span class="Identifier">LPCTSTR</span><span class="Other">;</span> <span class="Identifier">lang</span><span class="Other">:</span> <span class="Identifier">WORD</span> <span class="Other">=</span> <span class="DecNumber">0</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">HRSRC</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">inline</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Find the location of a resource with the specified type, name and language.

</dd>
<a id="sizeOfResource,MemoryModule,HRSRC"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#sizeOfResource%2CMemoryModule%2CHRSRC"><span class="Identifier">sizeOfResource</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">;</span> <span class="Identifier">resource</span><span class="Other">:</span> <span class="Identifier">HRSRC</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">DWORD</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Get the size of the resource in bytes.

</dd>
<a id="loadResource,MemoryModule,HRSRC"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#loadResource%2CMemoryModule%2CHRSRC"><span class="Identifier">loadResource</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">;</span> <span class="Identifier">resource</span><span class="Other">:</span> <span class="Identifier">HRSRC</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">HGLOBAL</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Get a pointer to the contents of the resource.

</dd>
<a id="loadString,MemoryModule,UINT,WORD"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#loadString%2CMemoryModule%2CUINT%2CWORD"><span class="Identifier">loadString</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">;</span> <span class="Identifier">id</span><span class="Other">:</span> <span class="Identifier">UINT</span><span class="Other">;</span> <span class="Identifier">lang</span><span class="Other">:</span> <span class="Identifier">WORD</span> <span class="Other">=</span> <span class="DecNumber">0</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">string</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">inline</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Load a string resource.

</dd>
<a id="unhook,MemoryModule"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#unhook%2CMemoryModule"><span class="Identifier">unhook</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Removes the hooks.

</dd>
<a id="hook,MemoryModule,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#hook%2CMemoryModule%2Cstring"><span class="Identifier">hook</span></a><span class="Other">(</span><span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">;</span> <span class="Identifier">name</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Hooks the system API (LoadLibrary and GetProcAddress only) with specified name. Following requests will be redirected to the memory module

</dd>
<a id="checkedMemLoopup,ptr.pointer,DllContent,LPCSTR"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#checkedMemLoopup%2Cptr.pointer%2CDllContent%2CLPCSTR"><span class="Identifier">checkedMemLoopup</span></a><span class="Other">(</span><span class="Identifier">callPtr</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">dll</span><span class="Other">:</span> <a href="memlib.html#DllContent"><span class="Identifier">DllContent</span></a><span class="Other">;</span> <span class="Identifier">sym</span><span class="Other">:</span> <span class="Identifier">LPCSTR</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

A helper used by <tt class="docutils literal"><span class="pre">memlib</span></tt> macro.

</dd>
<a id="memLoopup,ptr.pointer,DllContent,LPCSTR"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#memLoopup%2Cptr.pointer%2CDllContent%2CLPCSTR"><span class="Identifier">memLoopup</span></a><span class="Other">(</span><span class="Identifier">callPtr</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">dll</span><span class="Other">:</span> <a href="memlib.html#DllContent"><span class="Identifier">DllContent</span></a><span class="Other">;</span> <span class="Identifier">sym</span><span class="Other">:</span> <span class="Identifier">LPCSTR</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

A helper used by <tt class="docutils literal"><span class="pre">memlib</span></tt> macro.

</dd>
<a id="checkedLibLoopup,ptr.pointer,MemoryModule,LPCSTR"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#checkedLibLoopup%2Cptr.pointer%2CMemoryModule%2CLPCSTR"><span class="Identifier">checkedLibLoopup</span></a><span class="Other">(</span><span class="Identifier">callPtr</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">;</span> <span class="Identifier">sym</span><span class="Other">:</span> <span class="Identifier">LPCSTR</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

A helper used by <tt class="docutils literal"><span class="pre">memlib</span></tt> macro.

</dd>
<a id="libLoopup,ptr.pointer,MemoryModule,LPCSTR"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#libLoopup%2Cptr.pointer%2CMemoryModule%2CLPCSTR"><span class="Identifier">libLoopup</span></a><span class="Other">(</span><span class="Identifier">callPtr</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">lib</span><span class="Other">:</span> <a href="memlib.html#MemoryModule"><span class="Identifier">MemoryModule</span></a><span class="Other">;</span> <span class="Identifier">sym</span><span class="Other">:</span> <span class="Identifier">LPCSTR</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

A helper used by <tt class="docutils literal"><span class="pre">memlib</span></tt> macro.

</dd>
<a id="checkedRtLoopup,ptr.pointer,string,LPCSTR"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#checkedRtLoopup%2Cptr.pointer%2Cstring%2CLPCSTR"><span class="Identifier">checkedRtLoopup</span></a><span class="Other">(</span><span class="Identifier">callPtr</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">name</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">sym</span><span class="Other">:</span> <span class="Identifier">LPCSTR</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

A helper used by <tt class="docutils literal"><span class="pre">memlib</span></tt> macro.

</dd>
<a id="rtLoopup,ptr.pointer,string,LPCSTR"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#rtLoopup%2Cptr.pointer%2Cstring%2CLPCSTR"><span class="Identifier">rtLoopup</span></a><span class="Other">(</span><span class="Identifier">callPtr</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">pointer</span><span class="Other">;</span> <span class="Identifier">name</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">sym</span><span class="Other">:</span> <span class="Identifier">LPCSTR</span><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

A helper used by <tt class="docutils literal"><span class="pre">memlib</span></tt> macro.

</dd>
<a id="staticReadDllWithName,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#staticReadDllWithName%2Cstring"><span class="Identifier">staticReadDllWithName</span></a><span class="Other">(</span><span class="Identifier">dll</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">hint</span> <span class="Other">=</span> <span class="Identifier">true</span><span class="Other">)</span><span class="Other">:</span> <span class="Other">(</span><span class="Identifier">string</span><span class="Other">,</span> <a href="memlib.html#DllContent"><span class="Identifier">DllContent</span></a><span class="Other">)</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma">
    <span class="Identifier">compiletime</span><span class="Other">,</span> <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span>
    <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ReadEnvEffect</span><span class="Other">,</span> <span class="Identifier">ReadDirEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Compile-time find and read library proc for DLL embedding. Returns the path and the binary in DllContent format. Supports <tt class="docutils literal"><span class="pre">dynlib</span></tt> name patterns. For example: <tt class="docutils literal"><span class="pre">libtcl(|8.5|8.4)</span></tt>.

</dd>
<a id="staticReadDll,string"></a>
<dt><pre><span class="Keyword">proc</span> <a href="#staticReadDll%2Cstring"><span class="Identifier">staticReadDll</span></a><span class="Other">(</span><span class="Identifier">dll</span><span class="Other">:</span> <span class="Identifier">string</span><span class="Other">;</span> <span class="Identifier">hint</span> <span class="Other">=</span> <span class="Identifier">true</span><span class="Other">)</span><span class="Other">:</span> <a href="memlib.html#DllContent"><span class="Identifier">DllContent</span></a> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">compiletime</span><span class="Other">,</span>
    <span class="Identifier">raises</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ValueError</span><span class="Other">,</span> <span class="Identifier">LibraryError</span><span class="Other">]</span><span class="Other">,</span> <span class="Identifier">tags</span><span class="Other">:</span> <span class="Other">[</span><span class="Identifier">ReadEnvEffect</span><span class="Other">,</span> <span class="Identifier">ReadDirEffect</span><span class="Other">]</span></span><span class="Other">.}</span></span></pre></dt>
<dd>

Compile-time find and read library proc for DLL embedding. Returns the binary in DllContent format. Supports <tt class="docutils literal"><span class="pre">dynlib</span></tt> name patterns. For example: <tt class="docutils literal"><span class="pre">libtcl(|8.5|8.4)</span></tt>.

</dd>

</dl></div>
<div class="section" id="17">
<h1><a class="toc-backref" href="#17">Macros</a></h1>
<dl class="item">
<a id="checkedMemlib.m,untyped,untyped"></a>
<dt><pre><span class="Keyword">macro</span> <a href="#checkedMemlib.m%2Cuntyped%2Cuntyped"><span class="Identifier">checkedMemlib</span></a><span class="Other">(</span><span class="Identifier">dll</span><span class="Other">,</span> <span class="Identifier">def</span><span class="Other">:</span> <span class="Identifier">untyped</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">untyped</span></pre></dt>
<dd>

<tt class="docutils literal"><span class="pre">dynlib</span></tt> pragma replacement to load DLL from memory or at runtime. Raise <tt class="docutils literal"><span class="pre">LibraryError</span></tt> if error occurred. See <tt class="docutils literal"><span class="pre">memlib</span></tt> for details.

</dd>
<a id="memlib.m,untyped,untyped"></a>
<dt><pre><span class="Keyword">macro</span> <a href="#memlib.m%2Cuntyped%2Cuntyped"><span class="Identifier">memlib</span></a><span class="Other">(</span><span class="Identifier">dll</span><span class="Other">,</span> <span class="Identifier">def</span><span class="Other">:</span> <span class="Identifier">untyped</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">untyped</span></pre></dt>
<dd>

<tt class="docutils literal"><span class="pre">dynlib</span></tt> pragma replacement to load DLL from memory or at runtime. Accepts a <tt class="docutils literal"><span class="pre">MemoryModule</span></tt>, <tt class="docutils literal"><span class="pre">DllContent</span></tt>, or <tt class="docutils literal"><span class="pre">string</span></tt>. <strong>The program will crash if error occurred, so only use this for trusted DLL.</strong><table border="1" class="docutils"><tr><th>Parameter</th><th>Meaning</th></tr>
<tr><td>MemoryModule</td><td>Uses the DLL loaded by <tt class="docutils literal"><span class="pre">loadLib</span></tt> or <tt class="docutils literal"><span class="pre">checkedLoadLib</span></tt>.</td></tr>
<tr><td>DllContent</td><td>Loads DLL in binary format that returned by <tt class="docutils literal"><span class="pre">staticReadDll</span></tt>.</td></tr>
<tr><td>string</td><td>Loads the DLL at runtime by system API.</td></tr>
</table>
<p><strong class="examples_text">Examples:</strong></p>
<pre class="listing"><span class="Keyword">const</span>
  <span class="Identifier">dll</span> <span class="Other">=</span> <span class="Identifier">staticReadDll</span><span class="Other">(</span><span class="StringLit">&quot;sqlite3_64.dll&quot;</span><span class="Other">)</span>
<span class="Keyword">let</span> <span class="Identifier">lib</span> <span class="Other">=</span> <span class="Identifier">loadLib</span><span class="Other">(</span><span class="Identifier">dll</span><span class="Other">)</span>
<span class="Keyword">proc</span> <span class="Identifier">libversion</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">cdecl</span><span class="Other">,</span> <span class="Identifier">memlib</span><span class="Other">:</span> <span class="Identifier">lib</span><span class="Other">,</span> <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;sqlite3_libversion&quot;</span></span><span class="Other">.}</span></span>
<span class="Identifier">echo</span> <span class="Identifier">libversion</span><span class="Other">(</span><span class="Other">)</span></pre>
<p><strong class="examples_text">Examples:</strong></p>
<pre class="listing"><span class="Keyword">const</span>
  <span class="Identifier">dll</span> <span class="Other">=</span> <span class="Identifier">staticReadDll</span><span class="Other">(</span><span class="StringLit">&quot;sqlite3_64.dll&quot;</span><span class="Other">)</span>
<span class="Keyword">proc</span> <span class="Identifier">libversion</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">cdecl</span><span class="Other">,</span> <span class="Identifier">memlib</span><span class="Other">:</span> <span class="Identifier">dll</span><span class="Other">,</span> <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;sqlite3_libversion&quot;</span></span><span class="Other">.}</span></span>
<span class="Identifier">echo</span> <span class="Identifier">libversion</span><span class="Other">(</span><span class="Other">)</span></pre>
<p><strong class="examples_text">Examples:</strong></p>
<pre class="listing"><span class="Keyword">proc</span> <span class="Identifier">libversion</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">cdecl</span><span class="Other">,</span> <span class="Identifier">memlib</span><span class="Other">:</span> <span class="StringLit">&quot;sqlite3_64.dll&quot;</span><span class="Other">,</span>
                          <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;sqlite3_libversion&quot;</span></span><span class="Other">.}</span></span>
<span class="Identifier">echo</span> <span class="Identifier">libversion</span><span class="Other">(</span><span class="Other">)</span></pre>

</dd>
<a id="withPragma.m,untyped,untyped"></a>
<dt><pre><span class="Keyword">macro</span> <a href="#withPragma.m%2Cuntyped%2Cuntyped"><span class="Identifier">withPragma</span></a><span class="Other">(</span><span class="Identifier">pragma</span><span class="Other">,</span> <span class="Identifier">body</span><span class="Other">:</span> <span class="Identifier">untyped</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">untyped</span></pre></dt>
<dd>

<tt class="docutils literal"><span class="pre">push</span></tt> pragma replacement.
<p><strong class="examples_text">Examples:</strong></p>
<pre class="listing"><span class="Keyword">proc</span> <span class="Identifier">test</span><span class="Other">(</span><span class="Other">)</span> <span class="Other">=</span>
  <span class="Keyword">const</span>
    <span class="Identifier">dll</span> <span class="Other">=</span> <span class="Identifier">staticReadDll</span><span class="Other">(</span><span class="StringLit">&quot;sqlite3_64.dll&quot;</span><span class="Other">)</span>
  <span class="Identifier">withPragma</span> <span class="Other">{</span><span class="Identifier">cdecl</span><span class="Other">,</span> <span class="Identifier">memlib</span><span class="Other">:</span> <span class="Identifier">dll</span><span class="Other">,</span> <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;sqlite3_libversion&quot;</span><span class="Other">}</span><span class="Other">:</span>
    <span class="Keyword">proc</span> <span class="Identifier">libversion</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span>
  <span class="Identifier">echo</span> <span class="Identifier">libversion</span><span class="Other">(</span><span class="Other">)</span>
</pre>

</dd>
<a id="buildPragma.m,untyped,untyped"></a>
<dt><pre><span class="Keyword">macro</span> <a href="#buildPragma.m%2Cuntyped%2Cuntyped"><span class="Identifier">buildPragma</span></a><span class="Other">(</span><span class="Identifier">pragma</span><span class="Other">,</span> <span class="Identifier">body</span><span class="Other">:</span> <span class="Identifier">untyped</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">untyped</span></pre></dt>
<dd>

<tt class="docutils literal"><span class="pre">pragma</span></tt> pragma replacement.
<p><strong class="examples_text">Examples:</strong></p>
<pre class="listing"><span class="Keyword">proc</span> <span class="Identifier">test</span><span class="Other">(</span><span class="Other">)</span> <span class="Other">=</span>
  <span class="Keyword">const</span>
    <span class="Identifier">dll</span> <span class="Other">=</span> <span class="Identifier">staticReadDll</span><span class="Other">(</span><span class="StringLit">&quot;sqlite3_64.dll&quot;</span><span class="Other">)</span>
  <span class="Identifier">buildPragma</span> <span class="Other">{</span><span class="Identifier">cdecl</span><span class="Other">,</span> <span class="Identifier">memlib</span><span class="Other">:</span> <span class="Identifier">dll</span><span class="Other">,</span> <span class="Identifier">importc</span><span class="Other">:</span> <span class="StringLit">&quot;sqlite3_libversion&quot;</span><span class="Other">}</span><span class="Other">:</span>
    <span class="Identifier">mylib</span>
  <span class="Keyword">proc</span> <span class="Identifier">libversion</span><span class="Other">(</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">cstring</span> <span><span class="Other">{</span><span class="Other pragmadots">...</span><span class="Other">}</span></span><span class="pragmawrap"><span class="Other">{.</span><span class="pragma"><span class="Identifier">mylib</span></span><span class="Other">.}</span></span>
  <span class="Identifier">echo</span> <span class="Identifier">libversion</span><span class="Other">(</span><span class="Other">)</span>
</pre>

</dd>

</dl></div>

  </div>
</div>

    <div class="row">
      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br/>
        <small style="color: var(--hint);">Made with Nim.</small>
      </div>
    </div>
  </div>
</div>

</body>
</html>
